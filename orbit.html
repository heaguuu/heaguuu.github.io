<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>케플러 궤도 시뮬레이터</title>
  <style>
    canvas {
      background: #000;
      display: block;
      margin: auto;
    }
    #info {
      text-align: center;
      color: white;
      font-family: sans-serif;
      margin-top: 10px;
    }
  </style>
</head>

<body>
    <h2 style="text-align:center;">제2법칙 면적속도 일정의 법칙</h2>
   <canvas id="orbitCanvas" width="600" height="600"></canvas>
  <div id="info">케플러 제2법칙 시뮬레이터: 행성의 궤도 면적 속도 일정 원리</div>
  <div id="controls">
    <label for="speedSlider">속도 조절: </label>
    <input type="range" id="speedSlider" min="0.005" max="0.05" step="0.001" value="0.02">
    <span id="speedValue">0.020</span>
  </div>

  <script>
    const canvas = document.getElementById('orbitCanvas');
    const ctx = canvas.getContext('2d');
    const width = canvas.width;
    const height = canvas.height;

    // 타원 파라미터
    const a = 200; // 장반지름
    const b = 120; // 단반지름
    const focusX = Math.sqrt(a ** 2 - b ** 2);

    // 중심 좌표 (캔버스 중앙 기준)
    const cx = width / 2;
    const cy = height / 2;
    const sunX = cx - focusX;
    const sunY = cy;

    let angle = 0;
    let speedFactor = 0.02; // 초기 속도 조절값

    const speedSlider = document.getElementById('speedSlider');
    const speedValue = document.getElementById('speedValue');

    speedSlider.addEventListener('input', () => {
      speedFactor = parseFloat(speedSlider.value);
      speedValue.textContent = speedFactor.toFixed(3);
    });

    function getPlanetPosition(theta) {
      const x = cx + a * Math.cos(theta);
      const y = cy + b * Math.sin(theta);
      return { x, y };
    }

    function drawOrbit() {
      ctx.strokeStyle = 'gray';
      ctx.beginPath();
      for (let i = 0; i <= 360; i++) {
        const rad = i * Math.PI / 180;
        const { x, y } = getPlanetPosition(rad);
        if (i === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
      }
      ctx.closePath();
      ctx.stroke();
    }

    function drawSun() {
      ctx.fillStyle = 'yellow';
      ctx.beginPath();
      ctx.arc(sunX, sunY, 10, 0, 2 * Math.PI);
      ctx.fill();
    }

    function drawPlanet(x, y) {
      ctx.fillStyle = 'skyblue';
      ctx.beginPath();
      ctx.arc(x, y, 6, 0, 2 * Math.PI);
      ctx.fill();
    }

    function getSpeed(theta) {
      const r = a * (1 - 0.5 ** 2) / (1 + 0.5 * Math.cos(theta));
      return speedFactor * (1 / r);
    }

    function animate() {
      ctx.clearRect(0, 0, width, height);
      drawOrbit();
      drawSun();

      const { x, y } = getPlanetPosition(angle);
      drawPlanet(x, y);

      angle += getSpeed(angle);
      requestAnimationFrame(animate);
    }

    animate();
  </script>
</body>
</html>
